<!doctype html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" type="image/svg+xml" href="//localhost:1313/svg/icon.svg">
  <script src="//localhost:1313/js/loader.js"></script>
  <meta name="generator" content="Hugo 0.123.1">
  <link rel="stylesheet" href="//localhost:1313/css/colors.css"><link rel="stylesheet" href="//localhost:1313/css/styles.css">
  
  
  <title>Design decisions | llesha</title>
  <script type="module" src="//localhost:1313/js/interactive.js"></script>
</head>

<body>
  <div id="nav-border" class="container">
  <nav id="nav" class="nav justify-content-center">
    <div style="text-align: center; font-size: larger;">
      
      
      <a class="nav-link" href="/">Home</a>
      
      
      <a class="nav-link" href="/projects/">Projects</a>
      
      
      <a class="nav-link" href="/tags/">Tags</a>
      
    </div>
    <button id="change-theme-button">dark</button>
    <div style="justify-content: center;">
      <a href="https://github.com/llesha">GitHub</a>
      <a href="https://stackoverflow.com/users/19933941/llesha">StackOverflow</a>
      <a href="https://www.linkedin.com/in/llesha">LinkedIn</a>
    </div>
  </nav>
</div>
  <main id="main">
    

<h1>Design decisions</h1>




<i data-feather="calendar"></i> <time datetime="2022-10-27">27 October 2022</time>



<br><br>
<h2 id="why-null-is-0-now-it-is-not"><del>Why null is 0?</del> <em>now it is not</em></h2>
<p>First, let&rsquo;s provide some context.</p>
<p>I do not find void type useful. Therefore, void == null.</p>
<p>Now, let&rsquo;s state all cases when null appears:</p>
<ol>
<li>function call with no return</li>
<li>parent property<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></li>
<li><code>?.</code> operator.</li>
</ol>
<p>Not many cases to consider, only last one is the meaningful one. It is important to throw
exceptions for not found properties, because it might be a typo. Typos are hard to find. <code>?.</code>
operator exists if user intentionally wants to ignore non-existing property. This is very useful to
write concise code. Without <code>?.</code> we have to write something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="c1">// Say, want to check if svgArgs in a exist. 
</span></span></span><span class="line"><span class="cl"><span class="c1">// Then do some operations with them.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">properties</span><span class="p">.</span><span class="n">has</span><span class="p">(</span><span class="s2">&#34;svgArgs&#34;</span><span class="p">))</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span> <span class="c1">// without ?.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">?.</span><span class="n">svgArgs</span> <span class="o">!=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span> <span class="c1">// with ?.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">..</span><span class="p">.</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Better example:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">iter</span> <span class="p">=</span> <span class="k">if</span><span class="p">(</span><span class="n">parent</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="m">1</span> <span class="k">else</span> <span class="n">parent</span><span class="p">.</span><span class="n">iter</span> <span class="p">+</span> <span class="m">1</span> <span class="c1">// without ?.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">iter</span> <span class="p">=</span> <span class="n">parent</span><span class="o">?.</span><span class="n">iter</span> <span class="p">+</span> <span class="m">1</span> <span class="c1">// with ?.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>First example has a problem: when using <code>?.</code> we can&rsquo;t really differentiate whether <code>a</code> has a
property <code>svgArgs</code> which value is 0, or <code>a</code> does not have such property. However, I think it is an
issue only in a language where null as a no-reference exists.</p>
<p><strong>The answer to this question is:</strong></p>
<ol>
<li>I find 0 to be more useful than no-reference object, when null appears.</li>
<li>and for now I don&rsquo;t see many disadvantages of such design decision</li>
</ol>
<h2 id="defining-functions-in-language">Defining functions in language</h2>
<p>Embedded functions are functions that are translated from kotlin. All global functions and
type functions are embedded.
<a href="https://github.com/llesha/Regina/blob/ab48513b0a11ed21e710eec94660b7951137eafb/src/commonMain/kotlin/evaluation/FunctionFactory.kt#L49">Here is an implementation of global functions (GitHub).</a></p>
<p>It seems natural for me to shorten embedded functions quantity as much as possible (and write them
in created language<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>). I had three reasons to add many:</p>
<ol>
<li><strong>Historical reason.</strong> I was writing my own all-in-one parser-interpreter which was primitive (
yet usable) and adding
function parsing and evaluation was overwhelming.</li>
<li><strong>Logical reason.</strong> I cannot embed all the functions in the world. <code>log</code>, <code>write</code> and <code>read</code>
functions access lower-level APIs that are impossible to define in
a language itself (at least not in mine).</li>
<li><strong>Even more logical reason</strong>. If Regina&rsquo;s Array is just a MutableList from kotlin, why not use
existing implementations?</li>
</ol>
<h2 id="symbol-table">Symbol Table</h2>
<p>Symbol table is a common idea in language processing, it goes hand in hand
with <a href="../docs/Scopes.md">scopes</a>.</p>
<p>Symbol table is a solution to three concerns:</p>
<ol>
<li>Minding scopes,</li>
<li>Handling imports,</li>
<li>Recording variable names.</li>
</ol>
<p>It is organized as three tables:</p>
<ol>
<li><a href="https://github.com/llesha/Regina/blob/master/src/commonMain/kotlin/table/FileTable.kt">FileTable</a>
<ul>
<li>for storing all declarations in class (imports are references to other FileTables)</li>
</ul>
</li>
<li>VariableTable - contains all declarations for type instance (properties and functions).
VariableTable is a variable itself (class or a primitive).</li>
<li><a href="https://github.com/llesha/Regina/blob/master/src/commonMain/kotlin/table/ScopeTable.kt">ScopeTable</a>
<ul>
<li>contains all assigned variables inside a function body.</li>
</ul>
</li>
</ol>
<p>SymbolTable is a <a href="https://en.wikipedia.org/wiki/God_object">God-manager</a>, but it is needed to
handle all get requests (get function, get variable, etc).</p>
<h2 id="variable-names">Variable names</h2>
<p>Strings are keys for each map. Each string is a name for corresponding variable/type/function. It
solves third problem
and makes sharing reference-type values between variables straightforward, unlike storing name in
a variable class<sup id="fnref1:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> (how to store multiple names? When to
remove a name? etc.)
.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Probably I will remove <code>parent</code> property for non-class instances. I don&rsquo;t remember why this
feature exists. Nevertheless, it is too early to remove without giving it proper thought.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>At least to see how well language works.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>



  </main>
</body>

</html>